[TOC]
# 为什么要使用Request Id

## 1：当一个请求到来时，会产生哪些日志
```go
本次请求报文
本次请求涉及到的数据库操作
本次请求涉及到的缓存操作
本次请求涉及到的服务请求
本次请求所遭遇的异常
本次请求执行的关键函数
本次请求所对应的响应体
```
## 2: 如何查询本次从请求到响应全链路的所有日志
```go
使用 requestId 唯一标识每个请求，有时它又被称为 sessionId 或者 transactionId。

使用 requestId 标记每次请求全链路日志，所要标记的日志种类如上所示
通过把 X-Request-Id (X-Session-Id) 标记在请求头中，在整个链路进行传递
```

## 1: Request Id 是为了解决下面问题
```go
问题一： 客户端访问的Web服务时，如何将客户端请求与服务端日志关联 
问题二： 微服务架构下，访问日志如何查询
问题三： 不同项目交互出现异常，如何做日志关联
```

## 2: Request Id VS 没有Request Id

### 2.1:没有Request Id 请求
只能根据调用函数日志关键，在根据用户的输入的参数，时间来确定相关的日志。 如果项目是以分布式，微服务架构来实现， 上面查日志方式帮助很小。

原因如下

(1)代码层层封装后，无法通过日志关键与用户请求关联;
(2)微服务架构下，用户请求逻辑层分解多个子任务给下层服务处理，下层服务无法与用户请求关联;
(3)不同项目交互，如何在并发，错误重试，参数相同的情况下，无法通过关键字，时间来确定日志
### 2.2:使用Request Id
当前项目，根据request id 可以找到所有与请求相关的日志
不同项目，可以根据request id 确定唯一的请求
## 3. Request Id 好处
用户请求日志关联
项目间请求日志关联
多服务间日志聚合
调用关系分析
日志分析
## 4. Request Id 依赖
使用request id，要有配套日志记录系统
周边系统支持，保持统一
request id 每次用户请求，必须保证唯一。

